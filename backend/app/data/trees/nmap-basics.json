{
  "id": "nmap-basics",
  "title": "Nmap基礎スキャン",
  "description": "ポートスキャンから攻略までの手順",
  "root_node_id": "nmap-scan",
  "nodes": {
    "nmap-scan": {
      "id": "nmap-scan",
      "question": "Nmapスキャンを行う",
      "hint": "sudo nmap -sS <IP> -p- --min-rate 5000 -T4 -Pn",
      "hint_type": "command",
      "type": "select",
      "options": [
        {
          "id": "port-22",
          "label": "22",
          "next_node_ids": ["ssh-version", "ssh-brute", "ssh-key"]
        },
        {
          "id": "port-80",
          "label": "80",
          "next_node_ids": ["http-gobuster", "http-nikto"]
        },
        {
          "id": "port-443",
          "label": "443",
          "next_node_ids": ["https-cert", "https-manual"]
        }
      ]
    },
    "ssh-version": {
      "id": "ssh-version",
      "question": "SSHバージョン情報を確認",
      "hint": "ssh -v <IP>",
      "hint_type": "command",
      "type": "select",
      "options": [
        {
          "id": "ssh-exploit",
          "label": "脆弱性が見つかった"
        },
        {
          "id": "ssh-continue",
          "label": "既知の脆弱性なし"
        }
      ]
    },
    "ssh-brute": {
      "id": "ssh-brute",
      "question": "Hydraでブルートフォース攻撃",
      "hint": "hydra -l root -P /usr/share/wordlists/rockyou.txt ssh://<IP>",
      "hint_type": "command",
      "type": "select",
      "options": [
        {
          "id": "ssh-success",
          "label": "パスワードが見つかった"
        },
        {
          "id": "ssh-failed",
          "label": "パスワードが見つからない"
        }
      ]
    },
    "ssh-key": {
      "id": "ssh-key",
      "question": "公開鍵認証を試す",
      "hint": "他の攻略手段で秘密鍵を入手できた場合、それを使ってSSH接続を試みます。通常は /home/user/.ssh/id_rsa などに保存されています。",
      "hint_type": "text",
      "type": "select",
      "options": [
        {
          "id": "ssh-key-found",
          "label": "秘密鍵を入手済み"
        },
        {
          "id": "ssh-key-notfound",
          "label": "秘密鍵が見つからない"
        }
      ]
    },
    "http-gobuster": {
      "id": "http-gobuster",
      "question": "Gobusterでディレクトリ列挙",
      "hint": "gobuster dir -u http://<IP> -w /usr/share/wordlists/dirb/common.txt",
      "hint_type": "command",
      "type": "select",
      "options": [
        {
          "id": "found-admin",
          "label": "/admin を発見"
        },
        {
          "id": "found-upload",
          "label": "/upload を発見"
        },
        {
          "id": "found-api",
          "label": "/api を発見"
        }
      ]
    },
    "http-nikto": {
      "id": "http-nikto",
      "question": "Niktoで脆弱性スキャン",
      "hint": "nikto -h http://<IP>",
      "hint_type": "command",
      "type": "select",
      "options": [
        {
          "id": "nikto-sqli",
          "label": "SQLインジェクション可能性"
        },
        {
          "id": "nikto-xss",
          "label": "XSS脆弱性を発見"
        }
      ]
    },
    "https-cert": {
      "id": "https-cert",
      "question": "SSL証明書を確認",
      "hint": "openssl s_client -connect <IP>:443",
      "hint_type": "command",
      "type": "select",
      "options": [
        {
          "id": "cert-subdomain",
          "label": "サブドメイン情報を発見"
        },
        {
          "id": "cert-nothing",
          "label": "有益な情報なし"
        }
      ]
    },
    "https-manual": {
      "id": "https-manual",
      "question": "手動でブラウジング",
      "hint": "ブラウザでHTTPSサイトを開き、ページのソースコード、JavaScriptファイル、コメントなどを確認します。隠されたエンドポイントや認証情報が見つかることがあります。",
      "hint_type": "text",
      "type": "select",
      "options": [
        {
          "id": "manual-comment",
          "label": "HTMLコメントに情報"
        },
        {
          "id": "manual-js",
          "label": "JavaScriptに認証情報"
        }
      ]
    }
  }
}
